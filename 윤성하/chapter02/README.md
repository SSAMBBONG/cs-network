# 이더넷(Ethernet)

> LAN(특히 유선) 환경에서 대표적으로 사용되는 기술 (에테르에서 유래된 이름)

- 물리 계층: 신호, 배선
- 데이터 링크 계층: MAC 패킷, 프로토콜 형식 정의
- IEEE 802.3으로 표준화
- 802.3u, 802.3ab와 같이 다양한 뒤에 버전을 붙여 다양한 표준들이 존재
  - 표준에 따라 지원되는 네트워크 장비, [[통신 매체]]의 종류 및 전송 속도가 달라진다

`이더넷 이외에 토큰 링도 LAN 기술의 일종이다`

## 이더넷 프레임

> 이더넷 네트워크에서 주고받는 프레임

![Pasted image 20240506224131.png](../img/Pasted%20image%2020240506224131.png)

- 프리앰블(Preamble)
  - 이더넷 프레임의 시작을 알린다(이 프레임은 이더넷이야!)
  - 이를 통해 수신자는 해당 프레임이 이더넷 프로토콜임을 알 수 있다.
- MAC주소

  - 일반적으로 고유한 주소를 가지고 있다.
  - 네트워크 인터페이스마다 부여 → NIC이 여러 개 있다면 MAC도 여러개
  - 대표적인 예: NIC

  ```
  TMI
  대부분의 공유기에는 MAC주소를 변경할 수 있는 기능이 있다.
  이를 통해 ip를 새로 할당받아 ip 차단을 우회하기도 한다
  ```

- 타입/길이
  - 값이 1500 이하라면 프레임의 길이
  - 값이 1536 이상이라면 타입
    - 이더타입이라고도 부른다
    - 상위 계층에서 사용된 프로토콜을 명시 ex) ARP, IPv4, IPv6 …
- 데이터
  - 상위 계층(네트워크)의 데이터와 헤더를 합친 데이터
  - 최대 1500바이트, 최소 46바이트(최솟값을 맞추기 위해 패딩을 한다)
- FCS(Frame Check Sequence) ← 트레일러이다
  - 오류 검출
  - CRC(Cyclic Redundancy Check)값을 사용
    - CRC는 프리앰블과 FCS를 제외한 값들로만 계산한다

## NIC

> 호스트를 네트워크에 연결하기 위한 하드웨어
> 노드와 유무선 통신 매체를 연결하고 신호 변환을 담당

- 통신 매체 신호 ←→ 프레임 변환
- 자신과 관련 없는 프레임이라면 폐기
- FCS 필드를 통해 오류 검출 → 폐기

## 트위스티드 페어 케이블

> 구리선

- 일상에서 주로 사용하는 케이블(랜선)
- 케이블과 커넥터로 이루어져 있다
- 노이즈를 줄이기 위해 실드 사용

## 광섬유 케이블

> 빛을 이용해서 통신

- 빠르다, 멀리 간다
- 대륙 간 네트워크 연결에 사용
- 케이블과 커넥터로 구성
- 코어의 지름에 따라 싱글 모드와 멀티 모드로 나뉜다

## 허브

> 물리 계층에서의 네트워크 장비
> 여러 대의 호스트를 연결하는 장치

- 전달받은 신호를 다른 모든 포트로 다시 전송
  - 주소 개념이 없는 물리 계층이기에 수신지 특정 불가
  - 수신지에서 MAC주소(캡슐화 되어있다)를 통해 관련없는 프레임은 폐기
- 반이중(Half-Duplex) 통신

  ![Pasted image 20240506233102.png](../img/Pasted%20image%2020240506233102.png)

  - 동시에 송수신이 불가능하다 → 동시에 신호를 보낸다면? → 충돌(Collision)
  - **콜리전 도메인**: 충돌이 발생할 수 있는 영역(같은 허브를 사용)

### CSMA/CD

> 반이중 네트워크에서 충돌 방지 프로토콜 ← 접근 제어

1. 현재 전송 가능한 상태인지 확인 (Carrier Sense)
2. 전송 가능한 상태라면 → 전송 (만약 동시여 여러 호스트가 전송했다면 Multiple Access)
3. 확인하고 보냈는데도 충돌 → 랜덤시간 대기 후 다시 전송 (Collision Detection)

```
또 다른 물리 계층 장비로는 리피터가 있다.
리피터는 신호 증폭
```

## 스위치

> 데이터 링크 계층에서의 네트워크 장비

- 여러 호스트를 연결
- MAC 주소 학습
  - 특정 포트와 해당 포트에 연결된 호스트의 MAC 주소와의 관계를 기억
  - MAC 주소 테이블 형태로 저장
- 전이중 통신 지원

  ![Pasted image 20240506233146.png](../img/Pasted%20image%2020240506233146.png)

- VLAN

### MAC 주소 학습

시나리오: A → C로 프레임 전송

1. A → 스위치로 프레임 전송
2. 스위치는 Src Mac Address를 통해 A의 MAC 주소 파악 → 저장
3. 스위치에는 C의 MAC 정보가 없는 상태
4. 수신된 포트를 제외한 모든 포트로 프레임 전송(허브처럼)
   - 플러딩(Flooding)
5. B, C, D는 프레임을 수신
6. B, D는 Dest MAC Addr이 자신의 MAC이 아니므로 폐기
7. C는 스위치로 응답 프레임 전송
8. 스위치는 이를 통해 C의 MAC주소 저장
9. 또 다시 A와 C가 통신한다면 Flooding 과정 없이 C에게만 프레임 전송
   - 포워딩(Forwarding) 또한 B,D에게는 전송하지 않으므로 필터링(Filtering)
10. 일정 시간동안 해당 포트에서 프레임을 전송받지 못했다면 테이블에서 삭제
    - 에이징(Aging)

`MAC 주소 테이블이 가득 차게 되면 어떤 일이 발생할까?`

### VLAN

> 하나의 물리적 스위치로 여러 논리적인 LAN을 구축

- 각 VLAN은 서로 다르 네트워크로 간주한다
- 다른 VLAN에 속한 호스트끼리 통신하고자 한다면 네트워크 계층까지 올라가야 한다

- 포트 기반, MAC 기반 방식이 있다
